sap.ui.define(["jquery.sap.global","sap/ui/core/Control"],function(e,r){"use strict";return{handleRoleBasedPersona:function(r,t,n){var s=r.getMetadata().getManifestEntry("sap.app").id;var i=[new sap.ui.model.Filter("FaId",sap.ui.model.FilterOperator.EQ,s)];var d="/sap/opu/odata/sap/ZGECAGS010_SRV/";var c=new sap.ui.model.odata.v2.ODataModel(d);c.read("/MultiplePersonaSet",{filters:i,success:function(i,d){if(i!==undefined&&i.results!==undefined&&i.results.length>1){r._oDialog=sap.ui.xmlfragment("CLMPRJ_ID","zgecafa001util.zgecafa001util.fragments.PersonaSelectionView",r);r._oDialog.setEscapeHandler(function(){return});r._oDialog.setModel(new sap.ui.model.json.JSONModel(i));r._oDialog.open();sap.ui.core.Fragment.byId("CLMPRJ_ID","btnOk").attachPress(a.bind(this,s,r,t,n));sap.ui.core.Fragment.byId("CLMPRJ_ID","btnCancel").attachPress(o);var u=sap.ui.core.Fragment.byId("CLMPRJ_ID","idPersonaListItem").getItems()[0];sap.ui.core.Fragment.byId("CLMPRJ_ID","idPersonaListItem").setSelectedItem(u,r)}else{var l=i.results[0];c.create("/MultiplePersonaSet",l,{success:function(e,r){if(t!==undefined)t(l,e)},error:function(r){try{var t=e.parseJSON(r.responseText).error.innererror.errordetails[0].message}catch(e){t="An unexpected error has occurred. Contact your administrator."}if(n)n(t,r)}})}},error:function(r){try{var t=e.parseJSON(r.responseText).error.innererror.errordetails[0].message}catch(e){t="An unexpected error has occurred. Contact your administrator."}if(n)n(t,r)}})}};function t(e){var r=e.getSource().getParent();var t=e.getSource().getSelectedItem().getBindingContext().getObject();r.getParent().setModel(t,"PersonaModel")}function a(r,t,a,o){var n=t._oDialog;var s="/sap/opu/odata/sap/ZGECAGS010_SRV/";var i=new sap.ui.model.odata.v2.ODataModel(s);var d=sap.ui.core.Fragment.byId("CLMPRJ_ID","idPersonaListItem").getSelectedItem().getBindingContext().getObject();d.FaId=r;i.create("/MultiplePersonaSet",d,{success:function(e,r){if(a)a(d,e)},error:function(r){try{var t=e.parseJSON(r.responseText).error.innererror.errordetails[0].message}catch(e){t="An unexpected error has occurred. Contact your administrator."}if(o)o(t,r)}});n.close();n.destroy();n=undefined}function o(e){var r=e.getSource().getParent();r.close();r.destroy();r=undefined;window.history.go(-1)}},true);