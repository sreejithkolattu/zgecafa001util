sap.ui.define(["jquery.sap.global","sap/ui/core/Control","sap/ui/core/routing/History"],function(e,a,n){"use strict";return{handleLocking:function(a,n,t,o,s){var d=a;if(n===undefined||n===null||n===""){sap.m.MessageToast.show(" Workitem id is missing");return false}var u="/sap/opu/odata/sap/";u+=t?"":"Y88GECAGS004_SRV/";var c=new sap.ui.model.odata.v2.ODataModel(u);c.callFunction("/Check_Wi_Lock",{method:"GET",urlParameters:{Wid:n},success:function(e,a){if("addEventListener"in window){window.addEventListener("beforeunload",r.bind(this,n,t),this)}else if("attachEvent"in window){window.attachEvent("onbeforeunload",r.bind(this,n,t),this)}if(sap.ui.getCore().byId("backBtn")!==undefined)sap.ui.getCore().byId("backBtn").attachBrowserEvent("click",r.bind(this,n,t),this);if(sap.ui.getCore().byId("homeBtn")!==undefined)sap.ui.getCore().byId("homeBtn").attachBrowserEvent("click",i.bind(this,n,t),this);if(o)o(e,a)},error:function(a){try{var n=e.parseJSON(a.responseText).error.innererror.errordetails[0].message}catch(e){n="An unexpected error has occurred. Contact your administrator."}if(s)s(n,a)}})},handleUnLocking:function(a,n,t,o,s){var d=a;if(n===undefined||n===null||n===""){sap.m.MessageToast.show(" Workitem id is missing");return false}var u="/sap/opu/odata/sap";u+=t?"":"Y88GECAGS004_SRV/";var c=new sap.ui.model.odata.v2.ODataModel(u);c.callFunction("/Unlock_Wid",{method:"POST",urlParameters:{Wid:n},success:function(e,a){if("removeEventListener"in window){window.removeEventListener("beforeunload",r)}else if("detachEvent"in window){window.detachEvent("onbeforeunload",r)}if(sap.ui.getCore().byId("backBtn")!==undefined)sap.ui.getCore().byId("backBtn").detachBrowserEvent("click",r,this);if(sap.ui.getCore().byId("homeBtn")!==undefined)sap.ui.getCore().byId("homeBtn").detachBrowserEvent("click",i,this);sap.m.MessageToast.show(" Your Work item have unlocked !!!");if(o)o(e,a)},error:function(a){try{var n=e.parseJSON(a.responseText).error.innererror.errordetails[0].message}catch(e){n="An unexpected error has occurred. Contact your administrator."}if(s)s(n,a);sap.m.MessageToast.show("Error..!!")}})}};function t(e){var a=a||window.event;if(a){a.returnValue="message"}return"message"}function r(e,a){if(e===undefined||e===null||e===""){sap.m.MessageToast.show(" Workitem id is missing");return false}var n="/sap/opu/odata/sap/Y88GECAGS004_SRV/";var t=new sap.ui.model.odata.v2.ODataModel(n);t.callFunction("/Unlock_Wid",{method:"POST",urlParameters:{Wid:e},success:function(e,a){var n=sap.ushell.Container.getService("CrossApplicationNavigation");n.toExternal({target:{semanticObject:"WorkflowTask",action:"displayInbox"}})},error:function(e){}});return false}function i(e,a){if(e===undefined||e===null||e===""){sap.m.MessageToast.show(" Workitem id is missing");return false}var n="/sap/opu/odata/sap/Y88GECAGS004_SRV/";var t=new sap.ui.model.odata.v2.ODataModel(n);t.callFunction("/Unlock_Wid",{method:"POST",urlParameters:{Wid:e},success:function(e,a){var n=sap.ushell.Container.getService("CrossApplicationNavigation");n.toExternal({target:{shellHash:"#"}})},error:function(e){}});return false}},true);