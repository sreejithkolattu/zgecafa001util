sap.ui.define(["jquery.sap.global","sap/ui/model/Filter","sap/ui/comp/filterbar/FilterBar","sap/ui/model/FilterOperator","sap/ui/comp/valuehelpdialog/ValueHelpDialog","sap/ui/model/json/JSONModel","zgecafa001util/zgecafa001util/controls/FragmentUtility"],function(e,t,a,o,n,r,s){"use strict";return{showValueHelpDialog:function(e,t){try{t=t===null||t===undefined?b():t;t.autoFill=!f(t.autoFill)||t.autoFill?true:false;t.control=!f(t.control)?!f(t.isFragment)?sap.ui.core.Fragment.byId(e.createId(t.fragmentName),t.idOfUIElement):e.getView().byId(t.idOfUIElement):t.control;t.title=!f(t.title)?"Personnel Number":t.title;t.multiSelect=f(t.multiSelect)?t.multiSelect:false;t.isFragment=t.isFragment!==""&&t.isFragment?true:false;t.getToken=t.getToken!==""&&t.getToken?true:false;if(e.vhDialog!==undefined){e.vhDialog.destroy()}e.vhDialog=l(e,t)}catch(e){M(e)}}};function l(e,t){try{if(!f(t.reqestedField)){t.reqestedField="Pernr"}var a=new n(e.createId("F4H"),{basicSearchText:t.inputValue,title:t.title,supportMultiselect:t.multiSelect,supportRanges:false,supportRangesOnly:false,key:"Pernr",descriptionKey:"nachn",ok:function(o){var n=[],r=a.getTable(),s=r.getSelectedIndices();for(var l=0;l<s.length;l++){n.push(r.getModel().getProperty("/items/"+String(s[l])))}if(!t.autoFill){try{e.onValueHelpSelection(n,t.scenario);a.close()}catch(e){sap.m.MessageToast.show("Error while choosing Subordinate")}}else if(h(t.control)){try{if(t.getToken&&t.control.getEnableMultiLineMode()){t.control.setTokens(o.getParameter("tokens"));a.close()}else if(!t.getToken){t.control.setValue(n[0][t.reqestedField]);a.close()}}catch(e){sap.m.MessageToast.show("Error while choosing Subordinate")}if(t.oModel!==undefined&&t.control.getModel(t.oModel)!==undefined){if(t.control.getModel(t.oModel).getData().length>0){n.forEach(function(e){t.control.getModel(t.oModel).getData().push(e)})}else{t.control.getModel(t.oModel).setData(n)}t.control.getModel(t.oModel).refresh()}else if(t.oModel!==""&&t.oModel!==undefined){var i=new sap.ui.model.json.JSONModel;i.setData(n);t.control.setModel(i,t.oModel)}}else{sap.m.MessageToast.show("Error while choosing Subordinate")}a.close()},cancel:function(e){a.close()},afterClose:function(){a.destroy()}});d(null,a,e);a.setRangeKeyFields([{label:"Personnel ID",key:"Pernr"},{label:"Name",key:"Name1"}]);try{var o=t.fragmentName!==undefined&&t.fragmentName.length>0?sap.ui.core.Fragment.byId(e.createId(t.fragmentName),t.idOfUIElement):e.getView().byId(t.idOfUIElement);if(h(t.idOfUIElement)&&o!==undefined&&t.getToken&&t.oModel.length===0){a.setTokens(o.getTokens())}}catch(e){sap.m.MessageToast.show("Error while choosing Subordinate")}if(f(t.reqestedField)){c(e,a,t.reqestedField)}a.addStyleClass(e.theTokenInput!==undefined&&e.theTokenInput.$().closest(".sapUiSizeCompact").length>0?"sapUiSizeCompact":"sapUiSizeCozy");a.open();a.update();return a}catch(e){M(e)}}function i(e){if(e===undefined){sap.m.MessageToast.show("View is not available !!!");return false}else{return true}}function u(){try{var e=new r;e.setData([]);return e}catch(e){sap.m.MessageToast.show("Error !!!")}}function c(e,t,a){try{if(a===undefined){a="Pernr"}var o,n;if(e.getView().getModel("suggetionModel")===undefined){o=new r({PArea:[],PSArea:[],EmpInfo:[]});e.getView().setModel(o,"suggetionModel")}n=T(t);n.setModel(e.getView().getModel("suggetionModel"));T(t);t.setFilterBar(n)}catch(e){sap.m.MessageToast.show("Error !!!")}}function d(t,a,o){try{a.setBusy(true);var n="/sap/opu/odata/sap/ZGEPMGS002_SRV",r="SubordinatesSet",s=new sap.ui.model.odata.ODataModel(n,false);s.read(r,{success:e.proxy(g,o),error:e.proxy(p,o)})}catch(e){sap.m.MessageToast.show("Error while retrieving the list of Subordinates ");a.setBusy(false)}}function g(e,t){try{var a=this,o=new r({items:e.results});a.vhDialog.getTable().setModel(y(),"columns");a.vhDialog.getTable().setModel(u());a.vhDialog.getTable().setModel(o);a.vhDialog.getTable().bindRows({path:"/items"});a.vhDialog.setBusy(false)}catch(e){sap.m.MessageToast.show("Error while retrieving the list of Subordinates");a.vhDialog.setBusy(false)}}function p(t,a){try{var o=this,n=t.response.body,l=e.parseXML(n).querySelector("message").textContent,i=new r({Title:l,SubTitle:"Could not view the Subordinates",BtnOkText:"OK"});o.vhDialog.setBusy(false);o.vhDialog.close();s.handleErrorDialog(o,i,"FBFORM_ID_ID")}catch(e){o.vhDialog.setBusy(false);o.vhDialog.close();sap.m.MessageToast.show("Error while retrieving the list of Subordinates")}}function m(e,t){t.getTable().bindRows({path:"/items",filters:e})}function f(e){return e!==null&&e!==undefined}function h(e){return e!==null&&e!==undefined&&e!==""}function M(e){try{sap.m.MessageToast.show("Error:"+e.message);if(e.message.indexOf("adding element with duplicate id")!==-1){if(sap.ui.getCore().byId(e.message.split("'")[1])!==undefined){sap.ui.getCore().byId(e.message.split("'")[1]).destroy()}}}catch(e){sap.m.MessageToast.show("Error occurred")}}function w(){var e={basicSearchText:"",title:"Personnel Number",multiSelect:false,maxIncludeRanges:"2",supportRanges:false,supportRangesOnly:false,key:"Pernr",descriptionKey:"nachn",stretch:sap.ui.Device.system.phone};return e}function b(){return{title:"Personnel Number",control:null,getToken:true,idOfUIElement:"",reqestedField:"Pernr",multiSelect:false,inputValue:"",isFragment:false,view:"",oModel:"",fragmentName:"",autoFill:true,scenario:""}}function y(){try{var e=new sap.ui.model.json.JSONModel;e.setData({cols:[{label:"Personnal Number",template:"Pernr"},{label:"Name",template:"Cname"},{label:"Designation",template:"Plstx"},{label:"Personnel Area",template:"Btext"},{label:"Personnel Subarea",template:"Name1"}]});return e}catch(e){sap.m.MessageToast.show("Error !!!")}}function S(e,t,a,o,n,r,s,l,i){try{return new sap.ui.comp.filterbar.FilterGroupItem({groupTitle:e,groupName:t,name:a,label:o,control:new sap.m.Input({placeholder:r,type:sap.m.InputType.Text,showSuggestion:true})})}catch(e){sap.m.MessageToast.show("Error while searching Subordinates")}}function T(e){try{var t=new sap.ui.comp.filterbar.FilterBar({advancedMode:true,filterBarExpanded:true,filterGroupItems:[S("empGrp","gn1","n1","Personnel Number","searchInput1","Search Personnel Number","/items","{Pernr}","{Pernr}"),S("empGrp","gn1","n2","Name","searchInput2","Search Name","/items","{Cname}","{Cname}"),S("empGrp","gn1","n3","Designation","searchInput3","Search Designation","/items","{Plstx}","{Plstx}"),S("empGrp","gn1","n4","Personnel Area","searchInput4","Search Personnel Area","/items","{Werks}","{Btext}"),S("empGrp","gn1","n5","Personnel Subarea","searchInput5","Search Personnel Subarea","/items","{Btrtl}","{Name1}")],search:function(t){var a=t.getParameter("selectionSet"),o=a[0].getValue(),n=a[1].getValue(),r=a[2].getValue(),s=a[3].getValue(),l=a[4].getValue(),i=[new sap.ui.model.Filter("Pernr","Contains",o),new sap.ui.model.Filter("Cname","Contains",n),new sap.ui.model.Filter("Plstx","Contains",r),new sap.ui.model.Filter("Btext","Contains",s),new sap.ui.model.Filter("Name1","Contains",l)];m(i,e)}});return t}catch(e){sap.m.MessageToast.show("Error occurred")}}},true);