sap.ui.define(["jquery.sap.global","sap/ui/model/Filter","sap/ui/comp/filterbar/FilterBar","sap/ui/model/FilterOperator","sap/ui/comp/valuehelpdialog/ValueHelpDialog","sap/f/Avatar"],function(e,a,t,l,o,n){"use strict";return{showValueHelpDialog:function(e,a){try{a=a===null||a===undefined?w():a;a.idOfUIElement=!c(a.idOfUIElement)?"":a.idOfUIElement;a.autoFill=!c(a.autoFill)||a.autoFill?true:false;a.control=!c(a.control)?!c(a.isFragment)?sap.ui.core.Fragment.byId(e.createId(a.fragmentName),a.idOfUIElement):e.getView().byId(a.idOfUIElement):a.control;a.title=!c(a.title)?"Personnel Number":a.title;a.multiSelect=c(a.multiSelect)?a.multiSelect:false;a.isFragment=a.isFragment!==""&&a.isFragment?true:false;a.getToken=a.getToken!==""&&a.getToken?true:false;if(e.vhDialog!==undefined){e.vhDialog.destroy()}e.vhDialog=r(e,a)}catch(e){h(e)}},openQuickView:function(a,t,l){try{if(c(l)){if(!f(t,l)){if(t._oQuickView){t._oQuickView.destroy()}t._oQuickView=sap.ui.xmlfragment(t.createId("QuickView"),"zgecafa001util.zgecafa001util.fragments.EmployeeQuickView",this);t.getView().addDependent(t._oQuickView);u(t,l)}var o=a.getSource();e.sap.delayedCall(0,t,function(){t._oQuickView.openBy(o)})}else{sap.m.MessageToast.show("Employee Number is missing !!!")}}catch(e){h(e)}},handleUploadPopover:function(e,a,t){try{if(e===undefined){sap.m.MessageToast.show("Missing Source..!!");return false}t=t!==null&&t!==undefined?t:T("U");if(a._oInfoUploadPopover){a._oInfoUploadPopover.destroy()}a._oInfoUploadPopover=sap.ui.xmlfragment(a.createId("InfoUploadPopover"),"zgecafa001util.zgecafa001util.fragments.GenericUpload",this);a.getView().addDependent(a._oInfoUploadPopover);a._oInfoUploadPopover.setModel(t);sap.ui.core.Fragment.byId(a.createId("InfoUploadPopover"),"btnOk").attachPress(function(e){try{a._oInfoUploadPopover.close();a._oInfoUploadPopover.destroy()}catch(e){}});var l=e.hasOwnProperty("oSource")?e.getSource():e;a._oInfoUploadPopover.openBy(l)}catch(e){h(e)}}};function r(e,a){try{if(!c(a.reqestedField)){a.reqestedField="pernr"}var t=new sap.ui.comp.valuehelpdialog.ValueHelpDialog(e.createId("F4H"),{basicSearchText:a.inputValue,title:a.title,draggable:true,supportMultiselect:a.multiSelect,supportRanges:false,supportRangesOnly:false,key:"pernr",descriptionKey:"nachn",ok:function(l){var o=t.getTable(),n=[],r;if(o.getMetadata().getElementName()==="sap.ui.table.Table"){r=o.getSelectedIndices();for(var i=0;i<r.length;i++){n.push(o.getContextByIndex(r[i]).getObject())}}else{r=o.getSelectedItems();for(var i=0;i<r.length;i++){n.push(o.getModel("empTableModel").getProperty(r[i].getBindingContextPath()))}}if(!a.autoFill){try{e.onValueHelpSelection(n,a.scenario);t.close()}catch(e){sap.m.MessageToast.show(" Implement of onValueHelpSelection(oModel) is missing")}}else if(g(a.control)){try{if(a.getToken&&a.control.getEnableMultiLineMode()){a.control.setTokens(l.getParameter("tokens"));t.close()}else if(!a.getToken){a.control.setValue(n[0][a.reqestedField]);t.close()}}catch(e){sap.m.MessageToast.show("Token assingment failed.")}if(a.oModel!==undefined&&a.control.getModel(a.oModel)!==undefined){if(a.control.getModel(a.oModel).getData().length>0){n.forEach(function(e){a.control.getModel(a.oModel).getData().push(e)})}else{a.control.getModel(a.oModel).setData(n)}a.control.getModel(a.oModel).refresh()}else if(a.oModel!==""&&a.oModel!==undefined){var s=new sap.ui.model.json.JSONModel;s.setData(n);a.control.setModel(s,a.oModel)}}else{sap.m.MessageToast.show("Element is not available !!!")}t.close()},cancel:function(e){t.close()},afterClose:function(){t.destroy()}});var l="/sap/opu/odata/sap/ZDD_SH_PERSON_CDS/";var o=new sap.ui.model.odata.v2.ODataModel(l,{defaultCountMode:"None"});var r="/ZDD_SH_PERSON";t.setModel(o,"valueHelpModel");var i="/sap/opu/odata/sap/ZGECAGS006_SRV/";var p=new sap.ui.model.odata.v2.ODataModel(i,{defaultCountMode:"None"});t.setModel(p,"valueHelpModelPerAreaPerSubarea");t.getTableAsync().then(function(e){var a="/ZDD_SH_PERSON";var t="/sap/opu/odata/sap/ZDD_SH_PERSON_CDS/";var l=new sap.ui.model.odata.v2.ODataModel(t);e.setModel(l,"empTableModel");if(e.bindRows){e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"",tooltip:""}),template:new n({src:"{empTableModel>ImageUrl}",displaySize:"XS",tooltip:"{ename}"}),width:"8%"}));e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"Officer",tooltip:"Officer"}),template:new sap.m.ObjectIdentifier({text:"{empTableModel>pernr}",title:"{empTableModel>ename}",tooltip:"{empTableModel>ename} / {empTableModel>pernr}"}),width:"28%"}));e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"Email id",tooltip:"Email id"}),template:new sap.m.Text({text:"{empTableModel>email}",tooltip:"{empTableModel>email}"})}));e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"Organizational unit",tooltip:"Organizational unit"}),template:new sap.m.Text({text:"{empTableModel>OrgUnitDescription}",tooltip:"{empTableModel>OrgUnitDescription}"})}));e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"Personnel area",tooltip:"Personnel area"}),template:new sap.m.Text({text:"{empTableModel>PersonnelAreaDescription}",tooltip:"{empTableModel>PersonnelAreaDescription}"})}));e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"Personnel subarea",tooltip:"Personnel subarea"}),template:new sap.m.Text({text:"{empTableModel>PersonnelSubareaDescription}",tooltip:"{PersonnelSubareaDescription}"})}))}if(e.bindItems){e.addColumn(new sap.m.Column({header:new sap.m.Label({text:"",tooltip:""}),width:"15%"}));e.addColumn(new sap.m.Column({header:new sap.m.Label({text:"Officer",tooltip:"Officer"})}));e.setGrowing(true);e.setGrowingThreshold(20);e.setGrowingScrollToLoad(true)}}.bind(e));t.setRangeKeyFields([{label:"Personnel ID",key:"pernr"},{label:"Employee Name",key:"nachn"}]);try{var u=a.fragmentName!==undefined&&a.fragmentName.length>0?sap.ui.core.Fragment.byId(e.createId(a.fragmentName),a.idOfUIElement):e.getView().byId(a.idOfUIElement);if(g(a.idOfUIElement)&&u!==undefined&&a.getToken&&a.oModel.length===0){t.setTokens(u.getTokens())}}catch(e){sap.m.MessageToast.show("Token assingment failed.")}if(c(a.reqestedField)){s(e,t,a.reqestedField)}t.addStyleClass(e.theTokenInput!==undefined&&e.theTokenInput.$().closest(".sapUiSizeCompact").length>0?"sapUiSizeCompact":"sapUiSizeCozy");e._oBasicSearchField=new sap.m.SearchField({placeholder:"Search for NRIC, personnel number, employee name and email id",showSearchButton:true,search:function(){t.getFilterBar().search()}});t.getFilterBar().setBasicSearch(e._oBasicSearchField);t.open();t.update();return t}catch(e){h(e)}}function i(e){if(e===undefined){sap.m.MessageToast.show("View is not available !!!");return false}else{return true}}function s(e,a,t){try{if(t===undefined){t="pernr"}var l=v(a);a.setFilterBar(l)}catch(e){sap.m.MessageToast.show("Error !!!")}}function p(e,a){try{var t="/sap/opu/odata/sap/ZDD_SH_PERSON_CDS/";var l=new sap.ui.model.odata.v2.ODataModel(t,{defaultCountMode:"InlineRepeat",useBatch:false});var o="/ZDD_SH_PERSON";if(!a.getTable().getModel("empTableModel")){a.getTable().setModel(l,"empTableModel")}if(a.getTable().getMetadata().getElementName()==="sap.ui.table.Table"){a.getTable().bindRows({model:"empTableModel",path:o,filters:e,events:{dataRequested:function(e){a.setBusy(true)}.bind(a),dataReceived:function(e){a.setBusy(false);a.getTable().getTitle().setText("Officers ("+e.getSource().getLength()+")");a.getTable().invalidate()}.bind(a)}})}else{var r=new sap.m.ColumnListItem({cells:[new n({src:"{empTableModel>ImageUrl}",displaySize:"XS",tooltip:"{empTableModel>ename}"}),new sap.m.ObjectIdentifier({text:"{empTableModel>pernr}",title:"{empTableModel>ename}",tooltip:"{empTableModel>ename} / {empTableModel>pernr}"})]});a.getTable().bindItems({model:"empTableModel",path:o,templateShareable:false,template:r,filters:e,events:{dataRequested:function(e){a.setBusy(true)}.bind(a),dataReceived:function(e){a.setBusy(false);a.getTable().setHeaderText("Officers ("+e.getSource().getLength()+")");a.getTable().invalidate()}.bind(a)}})}}catch(e){sap.m.MessageToast.show("Error !!!");a.setBusy(false)}}function u(a,t){try{if(c(t)){var l="/sap/opu/odata/sap/ZGECAGS006_SRV/";var o="EmpCardSet(Pernr='"+t+"')";var n=new sap.ui.model.odata.ODataModel(l,false);n.read(o,{success:e.proxy(d,a),error:e.proxy(m,a)})}}catch(e){sap.m.MessageToast.show("Error !!!")}}function d(e,a,t){try{var l="sap-icon://employee";if(e.Photo.length===0){e.Photo=l}var o={oEmpInfoData:[{pernr:e.Pernr,pageId:e.Pernr,header:"Employee Details",icon:e.Photo,title:e.Ename,description:e.PosName,groups:[{heading:"Contact Details",elements:[{label:"Mobile",value:e.Mobile,elementType:sap.m.QuickViewGroupElementType.mobile},{label:"Phone",value:e.Phone,elementType:sap.m.QuickViewGroupElementType.phone},{label:"Email",value:e.Email,emailSubject:"",elementType:sap.m.QuickViewGroupElementType.email}]}]}]};this._oQuickView.setModel(new sap.ui.model.json.JSONModel(o),"empQuickView")}catch(e){sap.m.MessageToast.show("Error !!!")}}function m(e,a,t){try{this.setBusy(false);sap.m.MessageToast.show("Error while retreaving data !!!")}catch(e){sap.m.MessageToast.show("Error !!!");this.setBusy(false)}}function c(e){return e!==null&&e!==undefined}function g(e){return e!==null&&e!==undefined&&e!==""}function f(e,a){try{return e._oQuickView!==undefined&&e._oQuickView.getModel("empQuickView").getData()!==undefined&&e._oQuickView.getModel("empQuickView").getData().oEmpInfoData!==undefined&&e._oQuickView.getModel("empQuickView").getData().oEmpInfoData[0].pageId===a}catch(e){return false}}function h(e){try{if(e.message.indexOf("adding element with duplicate id")!==-1){if(sap.ui.getCore().byId(e.message.split("'")[1])!==undefined){sap.ui.getCore().byId(e.message.split("'")[1]).destroy()}sap.m.MessageToast.show("An error occurred, Please try again")}else{sap.m.MessageToast.show("Error !!!"+e.message)}}catch(e){}}function b(){var e={basicSearchText:"",title:"Personnel Number",multiSelect:false,maxIncludeRanges:"2",supportRanges:false,supportRangesOnly:false,key:"pernr",descriptionKey:"nachn",stretch:sap.ui.Device.system.phone};return e}function w(){return{title:"Personnel Number",control:null,getToken:true,idOfUIElement:"",reqestedField:"pernr",multiSelect:false,inputValue:"",isFragment:false,view:"",oModel:"",fragmentName:"",autoFill:true,scenario:""}}function M(e,t,l,o,n,r,i,s,p,u,d){try{return new sap.ui.comp.filterbar.FilterGroupItem({groupTitle:e,groupName:t,name:l,label:o,control:new sap.m.Input(n,{placeholder:r,type:sap.m.InputType.Text,showSuggestion:true,startSuggestion:d,suggest:function(e){var t=e.getParameter("suggestValue");var l=e.getSource().getId(),o;var n=[];if(t){switch(l){case"searchInput1":n.push(new a("pernr",sap.ui.model.FilterOperator.Contains,t));break;case"searchInput2":n.push(new a("ename",sap.ui.model.FilterOperator.Contains,t));break;case"searchInput5":n.push(new a("srch_email",sap.ui.model.FilterOperator.Contains,t));break;case"searchInput7":n.push(new a("Persa",sap.ui.model.FilterOperator.Contains,t));break;case"searchInput8":n.push(new a("Persa",sap.ui.model.FilterOperator.Contains,t));break}}e.getSource().getBinding("suggestionItems").filter(n);e.getSource().setFilterSuggests(false)},suggestionItems:{path:i,model:u,template:new sap.ui.core.Item({text:p,key:s})}})})}catch(e){}}function v(e){try{var t=new sap.ui.comp.filterbar.FilterBar({advancedMode:true,filterBarExpanded:true,filterGroupItems:[new sap.ui.comp.filterbar.FilterGroupItem("searchInput9",{groupTitle:"empGrp",groupName:"gn1",name:"n9",label:"NRIC",control:new sap.m.Input({placeholder:"Enter NRIC"})}),M("empGrp","gn1","n1","Personnel number","searchInput1","Enter personnel number","/ZDD_SH_PERSON","{valueHelpModel>pernr}","{valueHelpModel>pernr}","valueHelpModel",3),M("empGrp","gn1","n2","Employee name","searchInput2","Enter employee name","/ZDD_SH_PERSON","{valueHelpModel>ename}","{valueHelpModel>ename}","valueHelpModel",3),M("empGrp","gn1","n5","Email id","searchInput5","Enter email id","/ZDD_SH_PERSON","{valueHelpModel>srch_email}","{valueHelpModel>srch_email}","valueHelpModel",3),new sap.ui.comp.filterbar.FilterGroupItem("searchInput6",{groupTitle:"empGrp",groupName:"gn1",name:"n6",label:"Organizational unit",control:new sap.m.Input({placeholder:"Enter organizational unit"})}),M("empGrp","gn1","n7","Personnel area","searchInput7","Enter personnel area","/PerAreaSet","{valueHelpModelPerAreaPerSubarea>Persa}","{valueHelpModelPerAreaPerSubarea>Persa} - {valueHelpModelPerAreaPerSubarea>Name1}","valueHelpModelPerAreaPerSubarea",1),M("empGrp","gn1","n8","Personnel subarea","searchInput8","Enter personnel subarea","/PerSubAreaSet","{valueHelpModelPerAreaPerSubarea>Persa}","{valueHelpModelPerAreaPerSubarea>Persa} - {valueHelpModelPerAreaPerSubarea>Btext}","valueHelpModelPerAreaPerSubarea",1)],search:function(t){var o=this._oBasicSearchField.getValue();var n=[];var r=[];var i=[];if(o.trim().length>0){r.push(new a({filters:[new a({path:"ename",operator:l.Contains,value1:o.trim()}),new a({path:"pernr",operator:l.Contains,value1:o.trim()}),new a({path:"srch_email",operator:l.Contains,value1:o.trim()}),new a({path:"NricNumber",operator:l.Contains,value1:o.trim()})],and:false}))}var s=t.getParameter("selectionSet");var u=s[0].getValue();var d=s[1].getValue();var m=s[2].getValue();var c=s[3].getValue();var g=s[4].getValue();var f=s[5].getValue();var h=s[6].getValue();if(u.trim().length>0){i.push(new a({path:"NricNumber",operator:l.Contains,value1:u.trim()}))}if(d.trim().length>0){i.push(new a({path:"pernr",operator:l.Contains,value1:d.trim()}))}if(m.trim().length>0){i.push(new a({path:"ename",operator:l.Contains,value1:m.trim()}))}if(g.trim().length>0){i.push(new a({path:"orgeh",operator:l.Contains,value1:g.trim()}))}if(f.trim().length>0){i.push(new a({path:"werks",operator:l.Contains,value1:f.trim()}))}if(h.trim().length>0){i.push(new a({path:"PersonnelSubarea",operator:l.Contains,value1:h.trim()}))}if(c.trim().length>0){i.push(new a({path:"srch_email",operator:l.Contains,value1:c.trim()}))}if(r.length===0&&i.length===0){sap.m.MessageToast.show("Pass value to the filter items");return}if(r.length>0&&i.length>0){r.push(new a(i,true));n.push(new a({filters:r,and:true}))}else if(i.length>0){n.push(new a({filters:i,and:true}))}else if(r.length>0){n.push(new a({filters:r,and:true}))}p(n,e)}});return t}catch(e){sap.m.MessageToast.show("Error in filter bar")}}function T(e){if(e==="U"){return new sap.ui.model.json.JSONModel({Title:" Information",BodyText:"<p>1. Maximum file size to be upload is 2 MB.<br />2. Supported file types: PDF, JPG, PNG, JPEG.</p>",BtnOkText:"CLOSE"})}}},true);