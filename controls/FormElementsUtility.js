sap.ui.define(["jquery.sap.global","sap/ui/model/Filter","sap/ui/comp/filterbar/FilterBar","sap/ui/model/FilterOperator","sap/ui/comp/valuehelpdialog/ValueHelpDialog","sap/f/Avatar"],function(e,t,a,n,o,r){"use strict";return{showValueHelpDialog:function(e,t){try{t=t===null||t===undefined?S():t;t.idOfUIElement=!w(t.idOfUIElement)?"":t.idOfUIElement;t.autoFill=!w(t.autoFill)||t.autoFill?true:false;t.control=!w(t.control)?!w(t.isFragment)?sap.ui.core.Fragment.byId(e.createId(t.fragmentName),t.idOfUIElement):e.getView().byId(t.idOfUIElement):t.control;t.title=!w(t.title)?"Personnel Number":t.title;t.multiSelect=w(t.multiSelect)?t.multiSelect:false;t.isFragment=t.isFragment!==""&&t.isFragment?true:false;t.getToken=t.getToken!==""&&t.getToken?true:false;if(e.vhDialog!==undefined){e.vhDialog.destroy()}e.vhDialog=s(e,t)}catch(e){v(e)}},openQuickView:function(t,a,n){try{if(w(n)){if(!y(a,n)){if(a._oQuickView){a._oQuickView.destroy()}a._oQuickView=sap.ui.xmlfragment(a.createId("QuickView"),"zgecafa001util.zgecafa001util.fragments.EmployeeQuickView",this);a.getView().addDependent(a._oQuickView);g(a,n)}var o=t.getSource();e.sap.delayedCall(0,a,function(){a._oQuickView.openBy(o)})}else{sap.m.MessageToast.show("Employee Number is missing !!!")}}catch(e){v(e)}},handleUploadPopover:function(e,t,a){try{if(e===undefined){sap.m.MessageToast.show("Missing Source..!!");return false}a=a!==null&&a!==undefined?a:O("U");if(t._oInfoUploadPopover){t._oInfoUploadPopover.destroy()}t._oInfoUploadPopover=sap.ui.xmlfragment(t.createId("InfoUploadPopover"),"zgecafa001util.zgecafa001util.fragments.GenericUpload",this);t.getView().addDependent(t._oInfoUploadPopover);t._oInfoUploadPopover.setModel(a);sap.ui.core.Fragment.byId(t.createId("InfoUploadPopover"),"btnOk").attachPress(function(e){try{t._oInfoUploadPopover.close();t._oInfoUploadPopover.destroy()}catch(e){}});var n=e.hasOwnProperty("oSource")?e.getSource():e;t._oInfoUploadPopover.openBy(n)}catch(e){v(e)}}};function s(e,t){try{if(!w(t.reqestedField)){t.reqestedField="pernr"}var a=new sap.ui.comp.valuehelpdialog.ValueHelpDialog(e.createId("F4H"),{basicSearchText:t.inputValue,title:t.title,draggable:true,supportMultiselect:t.multiSelect,supportRanges:false,supportRangesOnly:false,key:"pernr",descriptionKey:"nachn",ok:function(n){var o=a.getTable(),r=[],s;if(o.getMetadata().getElementName()==="sap.ui.table.Table"){s=o.getSelectedIndices();for(var l=0;l<s.length;l++){r.push(o.getModel().getProperty("/"+String(s[l])))}}else{s=o.getSelectedItems();for(var l=0;l<s.length;l++){r.push(o.getModel().getProperty(s[l].getBindingContextPath()))}}if(!t.autoFill){try{e.onValueHelpSelection(r,t.scenario);a.close()}catch(e){sap.m.MessageToast.show(" Implement of onValueHelpSelection(oModel) is missing")}}else if(b(t.control)){try{if(t.getToken&&t.control.getEnableMultiLineMode()){t.control.setTokens(n.getParameter("tokens"));a.close()}else if(!t.getToken){t.control.setValue(r[0][t.reqestedField]);a.close()}}catch(e){sap.m.MessageToast.show("Token assingment failed.")}if(t.oModel!==undefined&&t.control.getModel(t.oModel)!==undefined){if(t.control.getModel(t.oModel).getData().length>0){r.forEach(function(e){t.control.getModel(t.oModel).getData().push(e)})}else{t.control.getModel(t.oModel).setData(r)}t.control.getModel(t.oModel).refresh()}else if(t.oModel!==""&&t.oModel!==undefined){var i=new sap.ui.model.json.JSONModel;i.setData(r);t.control.setModel(i,t.oModel)}}else{sap.m.MessageToast.show("Element is not available !!!")}a.close()},cancel:function(e){a.close()},afterClose:function(){a.destroy()}});sap.ui.getCore().setModel(E());a.getTableAsync().then(function(e){e.setModel(i());if(e.bindRows){e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"",tooltip:""}),template:new r({src:"{ImageUrl}",displaySize:"XS",tooltip:"{ename}"}),width:"8%"}));e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"Officer",tooltip:"Officer"}),template:new sap.m.ObjectIdentifier({text:"{pernr}",title:"{ename}",tooltip:"{ename} / {pernr}"}),width:"28%"}));e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"Email id",tooltip:"Email id"}),template:new sap.m.Text({text:"{email}",tooltip:"{email}"})}));e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"Organizational unit",tooltip:"Organizational unit"}),template:new sap.m.Text({text:"{OrgUnitDescription}",tooltip:"{OrgUnitDescription}"})}));e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"Personnel area",tooltip:"Personnel area"}),template:new sap.m.Text({text:"{PersonnelAreaDescription}",tooltip:"{PersonnelAreaDescription}"})}));e.addColumn(new sap.ui.table.Column({label:new sap.m.Label({text:"Personnel subarea",tooltip:"Personnel subarea"}),template:new sap.m.Text({text:"{PersonnelSubareaDescription}",tooltip:"{PersonnelSubareaDescription}"})}));e.bindRows("/")}if(e.bindItems){e.addColumn(new sap.m.Column({header:new sap.m.Label({text:"",tooltip:""}),width:"15%"}));e.addColumn(new sap.m.Column({header:new sap.m.Label({text:"Officer",tooltip:"Officer"})}));var t=new sap.m.ColumnListItem({cells:[new r({src:"{ImageUrl}",displaySize:"XS",tooltip:"{ename}"}),new sap.m.ObjectIdentifier({text:"{pernr}",title:"{ename}",tooltip:"{ename} / {pernr}"})]});e.setGrowing(true);e.setGrowingThreshold(20);e.setGrowingScrollToLoad(true);e.bindItems({path:"/",template:t})}}.bind(e));a.setRangeKeyFields([{label:"Personnel ID",key:"pernr"},{label:"Employee Name",key:"nachn"}]);try{var n=t.fragmentName!==undefined&&t.fragmentName.length>0?sap.ui.core.Fragment.byId(e.createId(t.fragmentName),t.idOfUIElement):e.getView().byId(t.idOfUIElement);if(b(t.idOfUIElement)&&n!==undefined&&t.getToken&&t.oModel.length===0){a.setTokens(n.getTokens())}}catch(e){sap.m.MessageToast.show("Token assingment failed.")}if(w(t.reqestedField)){p(e,a,t.reqestedField)}a.addStyleClass(e.theTokenInput!==undefined&&e.theTokenInput.$().closest(".sapUiSizeCompact").length>0?"sapUiSizeCompact":"sapUiSizeCozy");e._oBasicSearchField=new sap.m.SearchField({placeholder:"Search for NRIC, personnel number, employee name and email id",showSearchButton:true,search:function(){a.getFilterBar().search()}});a.getFilterBar().setBasicSearch(e._oBasicSearchField);a.open();a.update();return a}catch(e){v(e)}}function l(e){if(e===undefined){sap.m.MessageToast.show("View is not available !!!");return false}else{return true}}function i(){try{var e=new sap.ui.model.json.JSONModel;e.setData([]);return e}catch(e){sap.m.MessageToast.show("Error !!!")}}function p(e,t,a){try{if(a===undefined){a="pernr"}var n;if(e.getView().getModel("suggetionModel")===undefined){n=new sap.ui.model.json.JSONModel({PArea:[],PSArea:[],EmpInfo:[]});e.getView().setModel(n,"suggetionModel")}var o=C(t);o.setModel(e.getView().getModel("suggetionModel"));u(e);t.setFilterBar(o)}catch(e){sap.m.MessageToast.show("Error !!!")}}function u(e){try{var t=e.getView().getModel("suggetionModel");if(t!==undefined){if(t.getData().PArea.length<1){M("/sap/opu/odata/sap/ZGECAGS006_SRV/PerAreaSet",e)}if(t.getData().PSArea.length<1){M("/sap/opu/odata/sap/ZGECAGS006_SRV/PerSubAreaSet",e)}if(t.getData().EmpInfo.length<1){M("/sap/opu/odata/sap/ZDD_SH_PERSON_CDS/ZDD_SH_PERSON?$select=pernr,ename,srch_email,NricNumber&$filter=substringof('',pernr) and substringof('',ename) and substringof('',orgeh) and substringof('',werks) and substringof('',btrtl) and substringof('',NricNumber)",e)}}}catch(e){sap.m.MessageToast.show("Error !!!")}}function d(t,a){try{a.setBusy(true);var n="/sap/opu/odata/sap/ZDD_SH_PERSON_CDS/";var o="ZDD_SH_PERSON";var r=new sap.ui.model.odata.ODataModel(n,false);r.read(o,{filters:t,success:e.proxy(c,a),error:e.proxy(m,a)})}catch(e){a.setBusy(false)}}function c(e,t,a){try{this.getTable().getModel().oData=e.results;if(this.getTable().getMetadata().getElementName()==="sap.ui.table.Table"){this.getTable().getTitle().setText("Officers ("+e.results.length+")")}else{this.getTable().setHeaderText("Officers ("+e.results.length+")")}this.getTable().getModel().refresh();this.getTable().invalidate();this.setBusy(false)}catch(e){sap.m.MessageToast.show("Error !!!");this.setBusy(false)}}function m(e,t,a){try{this.setBusy(false);sap.m.MessageToast.show("Error while retreaving data !!!")}catch(e){sap.m.MessageToast.show("Error !!!");this.setBusy(false)}}function g(t,a){try{if(w(a)){var n="/sap/opu/odata/sap/ZGECAGS006_SRV/";var o="EmpCardSet(Pernr='"+a+"')";var r=new sap.ui.model.odata.ODataModel(n,false);r.read(o,{success:e.proxy(f,t),error:e.proxy(h,t)})}}catch(e){sap.m.MessageToast.show("Error !!!")}}function f(e,t,a){try{var n="sap-icon://employee";if(e.Photo.length===0){e.Photo=n}var o={oEmpInfoData:[{pernr:e.Pernr,pageId:e.Pernr,header:"Employee Details",icon:e.Photo,title:e.Ename,description:e.PosName,groups:[{heading:"Contact Details",elements:[{label:"Mobile",value:e.Mobile,elementType:sap.m.QuickViewGroupElementType.mobile},{label:"Phone",value:e.Phone,elementType:sap.m.QuickViewGroupElementType.phone},{label:"Email",value:e.Email,emailSubject:"",elementType:sap.m.QuickViewGroupElementType.email}]}]}]};this._oQuickView.setModel(new sap.ui.model.json.JSONModel(o),"empQuickView")}catch(e){sap.m.MessageToast.show("Error !!!")}}function h(e,t,a){try{this.setBusy(false);sap.m.MessageToast.show("Error while retreaving data !!!")}catch(e){sap.m.MessageToast.show("Error !!!");this.setBusy(false)}}function w(e){return e!==null&&e!==undefined}function b(e){return e!==null&&e!==undefined&&e!==""}function y(e,t){try{return e._oQuickView!==undefined&&e._oQuickView.getModel("empQuickView").getData()!==undefined&&e._oQuickView.getModel("empQuickView").getData().oEmpInfoData!==undefined&&e._oQuickView.getModel("empQuickView").getData().oEmpInfoData[0].pageId===t}catch(e){return false}}function M(e,t){try{var a=new sap.ui.model.json.JSONModel;a.attachEventOnce("requestCompleted",function(e){var t=e.getParameter("url").split("/")[e.getParameter("url").split("/").length-1];if(a.getData().d!==undefined)if(t.indexOf("PerAreaSet")===0){this.getView().getModel("suggetionModel").getData().PArea=a.getData().d.results}else if(t.indexOf("PerSubAreaSet")===0){this.getView().getModel("suggetionModel").getData().PSArea=a.getData().d.results}else if(t.indexOf("ZDD_SH_PERSON")===0){this.getView().getModel("suggetionModel").getData().EmpInfo=a.getData().d.results}this.getView().getModel("suggetionModel").refresh()},t).loadData(e)}catch(e){return[]}}function v(e){try{if(e.message.indexOf("adding element with duplicate id")!==-1){if(sap.ui.getCore().byId(e.message.split("'")[1])!==undefined){sap.ui.getCore().byId(e.message.split("'")[1]).destroy()}sap.m.MessageToast.show("An error occurred, Please try again")}else{sap.m.MessageToast.show("Error !!!"+e.message)}}catch(e){}}function I(){var e={basicSearchText:"",title:"Personnel Number",multiSelect:false,maxIncludeRanges:"2",supportRanges:false,supportRangesOnly:false,key:"pernr",descriptionKey:"nachn",stretch:sap.ui.Device.system.phone};return e}function S(){return{title:"Personnel Number",control:null,getToken:true,idOfUIElement:"",reqestedField:"pernr",multiSelect:false,inputValue:"",isFragment:false,view:"",oModel:"",fragmentName:"",autoFill:true,scenario:""}}function P(e){try{var t=e.getTable().getColumns().length;for(var a=0;a<=t;a++){e.getTable().getColumns()[a].setVisible(a<2?true:sap.ui.Device.system.desktop)}}catch(e){sap.m.MessageToast.show("Error !!!")}}function E(){try{var e=[];var t=new sap.ui.model.json.JSONModel;t.setData(e);sap.ui.getCore().setModel(t);return t}catch(e){sap.m.MessageToast.show("Error !!!")}}function T(){try{var e=new sap.ui.model.json.JSONModel;e.setData({cols:[{label:"Email id",template:"email"},{label:"Organizational unit",template:"OrgUnitDescription"},{label:"Personnel area",template:"PersonnelAreaDescription"},{label:"Personnel subarea",template:"PersonnelSubareaDescription"}]});return e}catch(e){sap.m.MessageToast.show("Error !!!")}}function D(e,a,n,o,r,s,l,i,p){try{return new sap.ui.comp.filterbar.FilterGroupItem({groupTitle:e,groupName:a,name:n,label:o,control:new sap.m.Input(r,{placeholder:s,type:sap.m.InputType.Text,showSuggestion:true,suggest:function(e){var a=e.getParameter("suggestValue");var n=e.getSource().getId(),o;var r=[];if(a){switch(n){case"searchInput1":r.push(new t("pernr",sap.ui.model.FilterOperator.Contains,a));break;case"searchInput2":r.push(new t("ename",sap.ui.model.FilterOperator.Contains,a));break;case"searchInput5":r.push(new t("srch_email",sap.ui.model.FilterOperator.Contains,a));break;case"searchInput7":r.push(new t("Persa",sap.ui.model.FilterOperator.Contains,a));break;case"searchInput8":r.push(new t("Persa",sap.ui.model.FilterOperator.Contains,a));break}}e.getSource().getBinding("suggestionItems").filter(r);e.getSource().setFilterSuggests(false)},suggestionItems:{path:l,template:new sap.ui.core.Item({text:p,key:i})}})})}catch(e){}}function C(e){try{var a=new sap.ui.comp.filterbar.FilterBar({advancedMode:true,filterBarExpanded:true,filterGroupItems:[new sap.ui.comp.filterbar.FilterGroupItem("searchInput9",{groupTitle:"empGrp",groupName:"gn1",name:"n9",label:"NRIC",control:new sap.m.Input({placeholder:"Enter NRIC"})}),D("empGrp","gn1","n1","Personnel number","searchInput1","Enter personnel number","/EmpInfo","{pernr}","{pernr}"),D("empGrp","gn1","n2","Employee name","searchInput2","Enter employee name","/EmpInfo","{ename}","{ename}"),D("empGrp","gn1","n5","Email id","searchInput5","Enter email id","/EmpInfo","{srch_email}","{srch_email}"),new sap.ui.comp.filterbar.FilterGroupItem("searchInput6",{groupTitle:"empGrp",groupName:"gn1",name:"n6",label:"Organizational unit",control:new sap.m.Input({placeholder:"Enter organizational unit"})}),D("empGrp","gn1","n7","Personnel area","searchInput7","Enter personnel area","/PArea","{Persa}","{Persa} - {Name1}"),D("empGrp","gn1","n8","Personnel subarea","searchInput8","Enter personnel subarea","/PSArea","{Persa}","{Persa} - {Btext}")],search:function(a){var o=this._oBasicSearchField.getValue();var r=[];var s=[];var l=[];if(o){s.push(new t({filters:[new t({path:"ename",operator:n.Contains,value1:o}),new t({path:"pernr",operator:n.Contains,value1:o}),new t({path:"srch_email",operator:n.Contains,value1:o}),new t({path:"NricNumber",operator:n.EQ,value1:o})],and:false}))}var i=a.getParameter("selectionSet");var p=i[0].getValue();var u=i[1].getValue();var c=i[2].getValue();var m=i[3].getValue();var g=i[4].getValue();var f=i[5].getValue();var h=i[6].getValue();if(p){l.push(new t({path:"NricNumber",operator:n.Contains,value1:p}))}if(u){l.push(new t({path:"pernr",operator:n.Contains,value1:u}))}if(c){l.push(new t({path:"ename",operator:n.Contains,value1:c}))}if(g){l.push(new t({path:"orgeh",operator:n.Contains,value1:g}))}if(f){l.push(new t({path:"werks",operator:n.Contains,value1:f}))}if(h){l.push(new t({path:"PersonnelSubarea",operator:n.Contains,value1:h}))}if(m){l.push(new t({path:"srch_email",operator:n.Contains,value1:m}))}if(s.length>0&&l.length>0){s.push(new t(l,true));r.push(new t({filters:s,and:true}))}else if(l.length>0){r.push(new t({filters:l,and:true}))}else if(s.length>0){r.push(new t({filters:s,and:true}))}d(r,e)}});return a}catch(e){sap.m.MessageToast.show("Error in filter bar")}}function O(e){if(e==="U"){return new sap.ui.model.json.JSONModel({Title:" Information",BodyText:"<p>1. Maximum file size to be upload is 2 MB.<br />2. Supported file types: PDF, JPG, PNG, JPEG.</p>",BtnOkText:"CLOSE"})}}},true);